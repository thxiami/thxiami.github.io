<script title="utils">
  function rangeValidator(num, range) {
    if (typeof num !== 'number') {
      throw new TypeError('Type of variable num is error! Wanted type: number, get:' + typeof num)
    }

    if (typeof range !== 'object') {
      throw new TypeError('Type of variable range is error! Wanted type: object, get:' + typeof range)
    }

    if (range.hasOwnProperty('min')) {
      if (typeof range.min !== 'number') {
        throw new TypeError('Type of variable range.min is error! Wanted type: number, get:' + typeof range.min)
      }
    }

    if (range.hasOwnProperty('max')) {
      if (typeof range.max !== 'number') {
        throw new TypeError('Type of variable range.max is error! Wanted type: number, get:' + typeof range.max)
      }
    }

    if (range.hasOwnProperty('min') && range.hasOwnProperty('max')) {
      return num >= range.min && num <= range.max

    } else if (range.hasOwnProperty('min')) {
      return num >= range.min

    } else if (range.hasOwnProperty('max')) {
      return num <= range.max
    }
  }

  function getNumber(hint, range) {
    if (typeof hint !== 'string') {
      throw new TypeError('Type of variable hint is error! Wanted type: string, get:' + typeof num)
    }

    let num
    let isValid
    do {
      num = +prompt(hint)
      isValid = rangeValidator(num, range)
      if (!isValid) {
        alert('输入的数字超出允许范围或者输入的不是数字, 请点击确定后重新输入!')
      }
    } while (!isValid)

    return num

  }

  /**
   * 自定义保留小数的方法, 规则为四舍五入, 解决 toFixed() 方法的问题
   * 因为javascript 内部对于小数的存储机制的问题, 使用 toFixed 方法有时候会出现五舍六入情况, 不便于工程使用
   * 比如: "3.155".toFixed(2)  // "3.15"
   * @param {string/number}value  需要舍入的浮点数
   * @param {number}n             需要保留的位数
   * @return {string}             处理后的数字
   *                              以 string 形式返回,目的是为了能保留如 1.0 这样的形式,
   *                              如果以 number 形式返回, 则会返回 1
   */
  function roundFun(value, n) {
    // JavaScript 的 Math.round()函数对于 -1.5 的情况, 与预期不同
    // Math.round(-1.5) ----> -1
    // 需要先转换为绝对值进行取整
    let num = Math.round(Math.abs(value) * Math.pow(10, n)) / Math.pow(10, n)

    if (Number(value) >= 0) {
      return num.toFixed(n)
    } else {
      return '-' + num.toFixed(n)
    }
  }
</script>
<script id="ch0104/01" type="x">
  var a = Number(prompt())
  if (a > 0) {
    console.log('positive')
  } else if (a < 0) {
    console.log('negative')
  } else {
    console.log('zero')
  }
</script>

<script id="ch0105/01">
  let count = getNumber('请输入学生总数n, n 的允许取值范围为: 1 <= n <= 100', {
    min: 1,
    max: 100,
  })
  let total = 0
  for (let i = 0; i < count; i++) {
    total += getNumber(`请输入第${i + 1}个学生的年龄, 允许值为 15 ~ 25, 含 15 和 25`, {
      min: 1,
      max: 100,
    })
  }
  console.log(roundFun(total / count, 2))
</script>